# Spring Tests

В этом домашнем задании вам предстоит протестировать уже готовое приложение на Spring Boot. Как и в предыдущем задании, тесты будем писать интеграционные.

## Ссылки

* [Документация по тестированию приложения](https://spring.io/guides/gs/testing-web/)
* [Класс MockMvc – предназначен для тестирования контроллеров, позволяет тестировать контроллеры без запуска http-сервера](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/web/servlet/MockMvc.html)
* [Класс MockHttpServletResponse – представляет ответ сервера на HTTP запрос](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/mock/web/MockHttpServletResponse.html)
* [Класс MockMvcRequestBuilders – содержит методы запроса](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/test/web/servlet/request/MockMvcRequestBuilders.html)
* [Подключение Database Rider](https://github.com/database-rider/database-rider#spring)

## src/test/resources/application.yml

Нам необходима отдельная база данных, которая будет использоваться для тестирования приложения. Настройка подключения к тестовой базе выполняется в файле *src/test/resources/application.yml*

## Задачи

* Изучите файл с настройками базы для тестирования

## src/test/resources/datasets/people.yml

За наполнение базы данных тестовыми данными (фикстурами) отвечает библиотека *Database Rider* (нужная зависимость уже подключена к проекту).

## Задачи

* Изучите содержимое файла people.yml. Запрос из этого файла выполнится при старте приложения в тестах и наполнит базу тестовыми данными. Используйте эти данные при тестировании. Можете дополнить этот файл добавив дополнительные записи в базу.

## src/test/java/exercise/AppTest.java

Часть тестов для приложения уже написаны. Проверяется работа корневой страницы приложения, вывод всех людей и создание новой персоны. Изучите эти тесты и комментарии к коду, они помогут вам при написании собственных тестов.
Вам предстоит самостоятельно протестировать вывод конкретной персоны, обновление и удаление персоны.

## Задачи

* Добавьте для класса `AppTest` аннотацию `@AutoConfigureMockMvc`, чтобы можно было запускать тесты без поднятия сервера. Пример можно посмотреть в документации по [ссылке](https://spring.io/guides/gs/testing-web/).

* Протестируйте вывод конкретной сущности. Проверьте, что GET-запрос на адрес */people/{id}* возвращает код ответа 200 и тип содержимого JSON. Проверьте также, что вернувшийся JSON содержит нужные данные.

* Протестируйте, как происходит обновление данных персоны в базе. Проверьте, что PATCH-запрос на адрес */people/{id}* возвращает код ответа 200 и обновляет данные персоны с указанным id. Чтобы проверить, что сущность обновилась, выполните GET-запрос к станице */people* и убедитесь, что новые данные появились на странице, а старые больше не выводятся.

* Протестируйте удаление сущности из базы. Проверьте, что DELETE-запрос на адрес */people/{id}* возвращает код ответа 200 и удаляет сущность с указанным id. Чтобы проверить, что сущность удалилась, выполните GET-запрос к странице просмотра сущностей и проверьте, что удалённой сущности нет в списке.

## Подсказки

* Изучите блок импортов в файле *AppTest.java*, он подскажет, какие методы используются для выполнения PATCH и DELETE запросов
